<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Item_form</title>
    <meta content="width=device-width, initial-scale=1" name="viewport">

    <!--link Bootstrap Framework-->
    <link rel="stylesheet" href="assests/css/bootstrap.min.css">
    <link rel="stylesheet" href="styles/pos_styles.css">
    <link href="icons/css/all.min.css" rel="stylesheet">

</head>
<body>

<header>
    <!--  Defined nav links -->
    <nav class="navbar navbar-expand-lg bg-primary navColor">
        <div class="container-fluid">
            <a class="navbar-brand text-white fw-bold" href="index.html">
                <img src="assests/images/logo.jpg" alt="Logo" width="40" height="40"
                     class="d-inline-block align-text-center">
                POS-SYSTEM
            </a>
            <button aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation"
                    class="navbar-toggler"
                    data-bs-target="#navbarNavDropdown" data-bs-toggle="collapse" type="button">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavDropdown">
                <ul id="ul-list" class="navbar-nav  me-auto mb-2 mb-lg-0 text-white">
                    <li class="nav-item fs-5 ">
                        <a aria-current="page" class="nav-link text-white" href="index.html" id="linkHome">Home</a>
                    </li>
                    <li class="nav-item fs-5">
                        <a class="nav-link text-white table-hover " href="customer_form.html" id="linkCustomer">Customers</a>
                    </li>
                    <li class="nav-item fs-5">
                        <a class="nav-link text-white" href="item_form.html" id="linkItem">Items</a>
                    </li>
                    <li class="nav-item fs-5">
                        <a class="nav-link text-white" href="place-order_form.html" id="linkOrder">Orders</a>
                    </li>
                    <li class="nav-item fs-5">
                        <a class="nav-link text-white" href="order_details_form.html" id="linkPurchaseOrder">Order-Details</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<!-- ==================== Items Manage Content Start =====================-->


<section class="container-fluid mt-3" id="itemContent">

    <!-- ***** Section of Items Details Form ***** -->

    <!-- Title of the Item Form -->
    <section class="container-fluid mt-1">
        <div style="height: 10px; text-align: center">
            <h2 class="bg-secondary border border-2 border-secondary text-light"
                style="border-radius: 25px; font-family: 'poppins', sans-serif"> M A N A G E - I T E M S </h2>
        </div>
    </section>

    <!-- Item related data form -->
    <section class="container-fluid mt-5">

        <form id="itemForm">
            <!-- Define First Row-->
            <div class="row">
                <div class="mb-3 col">
                    <label class="form-label" for="txtItemCode">Item Code</label>
                    <input class="form-control" id="txtItemCode" placeholder="I00-001" type="text" name="code">
                    <p><small class="text-danger pl-1" id="lblItemCode"></small></p>
                </div>
                <div class="mb-3 col">
                    <label class="form-label" for="txtItemName">Item Name</label>
                    <input class="form-control" id="txtItemName" placeholder="White Rice" type="text"
                           name="description">
                    <p><small class="text-danger pl-1" id="lblItemName"></small></p>
                </div>
            </div>

            <!-- Define Second Row-->
            <div class="row">

                <div class="mb-3 col">
                    <label class="form-label" for="txtItemQty">Item Qty</label>
                    <input class="form-control" id="txtItemQty" placeholder="500" type="number" name="qtyOnHand">
                    <p><small class="text-danger pl-1" id="lblItemQty"></small></p>
                </div>

                <div class="mb-3 col">
                    <label class="form-label" for="txtItemPrice">Item Price</label>
                    <input class="form-control" id="txtItemPrice" placeholder="1500.00" type="number" name="unitPrice">
                    <p><small class="text-danger pl-1" id="lblItemPrice"></small></p>
                </div>

            </div>
        </form>
    </section>

    <!-- Section of Button Group -->
    <section class="container-fluid mt-1 button ">
        <button class="btn btn-primary" id="btnItemSave" type="button">Add Item</button>
        <button class="btn btn-success" id="btnUpdateItem" type="button">Update Item</button>
        <button class="btn btn-warning" id="btnGetAllItem" type="button">Get All Item</button>
        <button class="btn btn-danger" id="btnDeleteItem" type="button">Delete Item</button>
        <button class="btn btn-info" id="btnClearItem" type="button">Clear</button>
    </section>


    <!-- Section of Search Bar -->
    <section class="container-fluid mt-3">
        <form class="d-flex">
            <input aria-label="Search" class="form-control me-2" id="txtSearchItem" placeholder="Search Item..."
                   type="search">
            <button class="btn btn-outline-success" id="btnSearchItem" type="button">Search</button>
        </form>
    </section>


    <!-- Section of Item Table -->
    <section class="row mt-3">
        <div class="col" style="height: 297px; overflow-x: scroll">
            <table class="table table-bordered table-hover table-striped">
                <thead class="bg-secondary text-white" id="tableHead">
                <tr class="head">
                    <th scope="col">Item Code</th>
                    <th scope="col">Item Name</th>
                    <th scope="col">Item QTY</th>
                    <th scope="col">Item Price</th>

                </tr>
                </thead>
                <tbody id="itemTable" class="table-light  ">

                </tbody>
            </table>
        </div>
    </section>
</section>

<!--Import js for bootstrap-->
<script src="assests/js/bootstrap.min.js"></script>
<script src="assests/jquery/jquery-3.6.1.min.js"></script>

<!--<script>
    /** Store all the customer records */
var items = [];

/** Save  Item Click Event Function */
$('#btnItemSave').click(function () {
    // Calling SaveItem function...
    saveItem();
});

/** Get All Customer Click Event Function */
$('#btnGetAllItem').click(function () {
    // Calling loadAllItem function...
    loadAllItem();
    setData_Bind_Row_Events();
    clearTextFieldsItem();
});

/** Search Item Key Press Function */
$('#txtSearchItem').keypress(function (event) {
    if (event.which == 13) {
        //pass the parameter of event to search item function
        searchItem(event);
    }
});

/** Search Button Clicked Function */
$('#btnSearchItem').click(function (event) {
    //pass the parameter of event to search item function
    searchItem(event);
});


/** Text Fields Key down to focus functionalities... */

//disable tab key of all input fields using grouping selector
$("#txtItemCode,#txtItemName,#txtItemPrice,#txtItemQty").keydown(function (event) {
    if (event.key == "Tab") {
        event.preventDefault();
    }
});

$('#txtItemCode').keydown(function (event) {
    if (event.which == 13) {
        $('#txtItemName').focus();
    }
});

$('#txtItemName').keydown(function (event) {
    if (event.which == 13) {
        $('#txtItemPrice').focus();
    }
});

$('#txtItemPrice').keydown(function (event) {
    if (event.which == 13) {
        $('#txtItemQty').focus();
    }
});

$('#txtItemQty').keydown(function (event) {
    if (event.which == 13) {
        saveItem();
        confirm("Do you  Want To Save Item ?");
        $('#txtItemCode').focus();
    }
});


/*************************** F U N C T I O N S ***************************/

/** SAVE ITEMS FUNCTION ... */
function saveItem() {
    /** select all the four text fields and then get their typed values */
    let ItemCode = $('#txtItemCode').val();
    let ItemName = $('#txtItemName').val();
    let ItemPrice = $('#txtItemPrice').val();
    let ItemQty = $('#txtItemQty').val();

    /**  put all of these values inside a named container  */
    var item = {
        code: ItemCode,
        name: ItemName,
        price: ItemPrice,
        qty: ItemQty
    }
    /** Add the Item object to the array */
    items.push(item);

    // Calling loadAllItem function...
    loadAllItem();

    clearTextFieldsItem();
    // Calling setData_Bind_Row_Events function after the Item added...
    setData_Bind_Row_Events();
}

/** LOAD ALL ITEMS FUNCTION ... */
function loadAllItem() {
    /** remove all the table body content before adding data */
    $('#itemTable').empty();

    /** get all ITEMS records from the array */
    for (let item of items) {
        /** Using String Literals to do the define row  */
        var row = ` <tr><td>${item.code}</td><td>${item.name}</td><td>${item.price}</td><td>${item.qty}</td></tr>`;

        /** then add it to the table body of Item table */
        $('#itemTable').append(row);
    }
}

/** SEARCH ITEMS FUNCTION ... */
function searchItem(event) {
    for (let item of items) {

        if (item.code === $('#txtSearchItem').val() ||
            item.name === $('#txtSearchItem').val()) {
            /* Clear Table */
            $('#itemTable').empty();
            /** search result add it to the table body of customer table */
            let row = `<tr><td>${item.code}</td><td>${item.name}</td><td>${item.price}</td><td>${item.qty}</td></tr>`;
            $('#itemTable').append(row);
        } else {
            event.preventDefault();
        }
    }
}

/** BIND ROW CLICK EVENT FUNCTION ... */
function setData_Bind_Row_Events() {
    $('#itemTable>tr').click(function () {

        let code = $(this).children(':eq(0)').text();
        let name = $(this).children(':eq(1)').text();
        let price = $(this).children(':eq(2)').text();
        let qty = $(this).children(':eq(3)').text();

        /** setting table details values to text fields */
        $('#txtItemCode').val(code);
        $('#txtItemName').val(name);
        $('#txtItemPrice').val(price);
        $('#txtItemQty').val(qty);
    });
}

/** CLEAR TEXT FIELDS FUNCTION ... */
function clearTextFieldsItem() {
    $('#txtItemCode').val("");
    $('#txtItemName').val("");
    $('#txtItemPrice').val("");
    $('#txtItemQty').val("");
}

</script>-->

<script>
    loadAllItems();

    $("#btnGetAllItem").click(function () {
        loadAllItems();
        clearItemFields();
    });

    $("#btnItemSave").click(function () {

    });


    $("#btnClearItem").click(function () {
        clearItemFields();
    });

    function loadAllItems() {
        $("#itemTable").empty();
        $.ajax({
            url: "item",
            dataType: "json",
            success: function (resp) {
                for (let itm of resp.data) {
                    $("#itemTable").append("<tr> <td>" + itm.code + "</td> <td>" + itm.description + "</td> <td>" + itm.qtyOnHand + "</td> <td>" + itm.unitPrice + "</td></tr>");
                }
                setData_Bind_Row_Events();
                clearItemFields()
                $("#txtItemCode").focus();
            }


        });
    }

    /** BIND ROW CLICK EVENT FUNCTION ... */
    function setData_Bind_Row_Events() {
        $('#itemTable>tr').click(function () {

            let code = $(this).children(':eq(0)').text();
            let name = $(this).children(':eq(1)').text();
            let qty = $(this).children(':eq(2)').text();
            let price = $(this).children(':eq(3)').text();

            /** setting table details values to text fields */
            $('#txtItemCode').val(code);
            $('#txtItemName').val(name);
            $('#txtItemQty').val(qty);
            $('#txtItemPrice').val(price);
        });
    }

    function clearItemFields() {
        $('#txtItemCode').val("");
        $('#txtItemName').val("");
        $('#txtItemPrice').val("");
        $('#txtItemQty').val("");
    }


</script>

</body>
</html>